<!DOCTYPE html>
<html lang="en">
<!-- Previous head section remains the same until style -->
<style>
    /* Previous styles remain the same */
    .file-explorer {
        background: rgba(30, 30, 30, 0.95);
        border-radius: 8px;
    }
    .file-item {
        transition: all 0.2s ease;
    }
    .file-item:hover {
        background: rgba(255, 255, 255, 0.1);
    }
    .directory {
        color: #4299e1;
    }
    .file {
        color: #e2e8f0;
    }
    .upload-zone {
        border: 2px dashed rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
    }
    .upload-zone.drag-over {
        border-color: #4299e1;
        background: rgba(66, 153, 225, 0.1);
    }
</style>
<!-- Previous head section closing -->

<!-- Previous body opening and header remain the same -->

<main class="bg-white p-8 rounded-b-lg shadow-xl">
    <!-- Previous login and register forms remain the same -->

    <div id="dashboard" class="hidden">
        <!-- Previous status cards remain the same -->

        <!-- New File Explorer Section -->
        <div class="file-explorer p-6 rounded-lg mb-8 text-white">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold">File Explorer</h3>
                <div class="space-x-2">
                    <button id="new-file" class="px-3 py-1 bg-blue-500 rounded hover:bg-blue-600 transition-colors">
                        New File
                    </button>
                    <button id="new-directory" class="px-3 py-1 bg-green-500 rounded hover:bg-green-600 transition-colors">
                        New Directory
                    </button>
                    <button id="upload-file" class="px-3 py-1 bg-purple-500 rounded hover:bg-purple-600 transition-colors">
                        Upload Files
                    </button>
                </div>
            </div>
            
            <div id="upload-zone" class="upload-zone p-8 text-center mb-4 rounded-lg cursor-pointer">
                <p>Drag and drop files here or click to upload</p>
                <input type="file" id="file-input" multiple class="hidden">
            </div>

            <div id="file-tree" class="space-y-2">
                <!-- File tree will be populated here -->
            </div>
        </div>

        <!-- Previous command list and log sections remain the same -->
    </div>
</main>

<!-- Add the following script just before the closing body tag -->
<script>
// Previous script content remains the same until DOMContentLoaded

document.addEventListener('DOMContentLoaded', () => {
    // Previous initialization code remains the same
    
    // File System Structure
    let fileSystem = {
        'index.js': null,
        'commands': {
            'ping.js': null,
            'help.js': null
        },
        'events': {
            'ready.js': null,
            'interactionCreate.js': null
        },
        'config.json': null
    };

    // File System Functions
    function updateFileTree() {
        const fileTree = document.getElementById('file-tree');
        fileTree.innerHTML = '';
        
        function renderDirectory(structure, path = '') {
            for (const [name, content] of Object.entries(structure)) {
                const item = document.createElement('div');
                const fullPath = path ? `${path}/${name}` : name;
                
                if (content === null) {
                    // File
                    item.className = 'file-item file pl-4 py-1 cursor-pointer flex items-center';
                    item.innerHTML = `
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        ${name}
                    `;
                    item.addEventListener('click', () => editFile(fullPath));
                } else {
                    // Directory
                    item.className = 'file-item directory pl-4 py-1 cursor-pointer flex items-center';
                    item.innerHTML = `
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
                        </svg>
                        ${name}
                    `;
                    const subDirectory = document.createElement('div');
                    subDirectory.className = 'pl-4';
                    subDirectory.style.borderLeft = '1px solid rgba(255,255,255,0.1)';
                    renderDirectory(content, fullPath);
                    item.appendChild(subDirectory);
                }
                fileTree.appendChild(item);
            }
        }
        
        renderDirectory(fileSystem);
    }

    function createFile(path) {
        const name = prompt('Enter file name:');
        if (!name) return;
        
        const parts = path ? [...path.split('/'), name] : [name];
        let current = fileSystem;
        
        for (let i = 0; i < parts.length - 1; i++) {
            current = current[parts[i]];
        }
        
        current[parts[parts.length - 1]] = null;
        updateFileTree();
        appendLog(`Created file: ${parts.join('/')}`);
    }

    function createDirectory(path) {
        const name = prompt('Enter directory name:');
        if (!name) return;
        
        const parts = path ? [...path.split('/'), name] : [name];
        let current = fileSystem;
        
        for (let i = 0; i < parts.length - 1; i++) {
            current = current[parts[i]];
        }
        
        current[parts[parts.length - 1]] = {};
        updateFileTree();
        appendLog(`Created directory: ${parts.join('/')}`);
    }

    // File Upload Handling
    const uploadZone = document.getElementById('upload-zone');
    const fileInput = document.getElementById('file-input');

    uploadZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadZone.classList.add('drag-over');
    });

    uploadZone.addEventListener('dragleave', () => {
        uploadZone.classList.remove('drag-over');
    });

    uploadZone.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadZone.classList.remove('drag-over');
        handleFiles(e.dataTransfer.files);
    });

    uploadZone.addEventListener('click', () => {
        fileInput.click();
    });

    fileInput.addEventListener('change', (e) => {
        handleFiles(e.target.files);
    });

    function handleFiles(files) {
        Array.from(files).forEach(file => {
            const reader = new FileReader();
            reader.onload = (e) => {
                // Store file content in memory
                fileSystem[file.name] = null;
                updateFileTree();
                appendLog(`Uploaded file: ${file.name}`);
            };
            reader.readAsText(file);
        });
    }

    // Bot Control Enhancement
    document.getElementById('start-bot').addEventListener('click', async () => {
        appendLog('Starting bot with Node.js v20...');
        
        try {
            const response = await fetch('/api/bot/start', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ fileSystem })
            });
            
            if (!response.ok) throw new Error('Failed to start bot');
            
            const data = await response.json();
            appendLog('Bot started successfully!');
            
            // Set up WebSocket connection for real-time logs
            const ws = new WebSocket('ws://localhost:3000');
            ws.onmessage = (event) => {
                appendLog(event.data);
            };
        } catch (error) {
            appendLog(`Error starting bot: ${error.message}`);
        }
    });

    // Initialize UI
    document.getElementById('new-file').addEventListener('click', () => createFile());
    document.getElementById('new-directory').addEventListener('click', () => createDirectory());
    updateFileTree();

    // Previous helper functions remain the same
});
</script>
</body>
</html>
